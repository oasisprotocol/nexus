api: harden file server security

- Metrics Middleware: Now validates metric names for valid UTF-8 to prevent
Prometheus panics.

- Safe File Serving: Introduced a safeFileSystem wrapper that only serves
regular files, rejecting symlinks and directories, and added some additional
path validation.

- Added tests covering various edge cases, including invalid UTF-8, null byte
injection, and attempts to access restricted paths.
